{{ define "main" }}

<div class="homepage-content">
{{ .Content }}
</div>

<div class="narrow">
  <h2 class="recent-articles-heading">LATEST ARTICLE</h2>
</div>

<div class="narrow homepage-posts" id="recent-posts">
  {{ .Scratch.Set "pages" (where .Site.RegularPages "Type" "in" "posts") }}
  {{ if eq hugo.Environment "production" }}
  {{ .Scratch.Set "pages" (where (where .Site.RegularPages "Draft" false) "Type" "in" "posts") }}
  {{ end }}

  {{ $pages := (.Scratch.Get "pages") }}
  {{ $recentPosts := first 5 $pages }}
  {{ $firstPost := first 1 $recentPosts }}
  {{ $remainingPosts := after 1 $recentPosts }}

  {{ range $firstPost }}
  {{- partial "articles.html" . -}}
  {{ end }}
</div>

<a class="subscribe" href="/subscribe">subscribe</a>

<div class="narrow">
  <h2 class="recent-articles-heading">RECENT ARTICLES</h2>
</div>

<div class="narrow homepage-grid" id="recent-grid">
  {{ range $remainingPosts }}
  {{- partial "homepage-articles.html" . -}}
  {{ end }}
</div>

<div class="narrow">
  <div class="read-more-wrapper centered">
    <a href="/posts/" class="read-more-link">Read more posts &rarr;</a>
  </div>
</div>


{{ end }}
