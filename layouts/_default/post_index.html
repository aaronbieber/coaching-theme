{{ define "main" }}
  <div class="narrow">
    <h2 class="archives-heading">THE ARCHIVES</h2>
  </div>

  <div class="narrow posts-index">
    {{ .Scratch.Set "pages" (where .Site.RegularPages "Type" "in" "posts") }}
    {{ if eq hugo.Environment "production" }}
    {{ .Scratch.Set "pages" (where (where .Site.RegularPages "Draft" false) "Type" "in" "posts") }}
    {{ end }}

    {{ $allPages := (.Scratch.Get "pages") }}
    {{ $remainingPages := after 5 $allPages }}

    {{ range (.Paginate $remainingPages 5).Pages }}
    {{- partial "articles.html" . -}}
    {{ end }}

    <hr/>

    {{- partial "paginator.html" . -}}
  </div>


{{ end }}
